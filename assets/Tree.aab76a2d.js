import{i as p,e as E,b as F,S as z,F as J,f as K,g as Q,n as q,t as b,w as U,a as D,u as X,o as Y,k as ee,a1 as te,B,am as le,ar as ne}from"./index.68c18706.js";let ie={data:""},re=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||ie,ae=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,oe=/\/\*[^]*?\*\/|  +/g,P=/\n+/g,S=(e,t)=>{let o="",u="",f="";for(let r in e){let c=e[r];r[0]=="@"?r[1]=="i"?o=r+" "+c+";":u+=r[1]=="f"?S(c,r):r+"{"+S(c,r[1]=="k"?"":t)+"}":typeof c=="object"?u+=S(c,t?t.replace(/([^,])+/g,a=>r.replace(/(^:.*)|([^,])+/g,s=>/&/.test(s)?s.replace(/&/g,a):a?a+" "+s:s)):r):c!=null&&(r=/^--/.test(r)?r:r.replace(/[A-Z]/g,"-$&").toLowerCase(),f+=S.p?S.p(r,c):r+":"+c+";")}return o+(t&&f?t+"{"+f+"}":f)+u},_={},A=e=>{if(typeof e=="object"){let t="";for(let o in e)t+=o+A(e[o]);return t}return e},ce=(e,t,o,u,f)=>{let r=A(e),c=_[r]||(_[r]=(s=>{let h=0,g=11;for(;h<s.length;)g=101*g+s.charCodeAt(h++)>>>0;return"go"+g})(r));if(!_[c]){let s=r!==e?e:(h=>{let g,v,x=[{}];for(;g=ae.exec(h.replace(oe,""));)g[4]?x.shift():g[3]?(v=g[3].replace(P," ").trim(),x.unshift(x[0][v]=x[0][v]||{})):x[0][g[1]]=g[2].replace(P," ").trim();return x[0]})(e);_[c]=S(f?{["@keyframes "+c]:s}:s,o?"":"."+c)}let a=o&&_.g?_.g:null;return o&&(_.g=_[c]),((s,h,g,v)=>{v?h.data=h.data.replace(v,s):h.data.indexOf(s)===-1&&(h.data=g?s+h.data:h.data+s)})(_[c],t,u,a),c},se=(e,t,o)=>e.reduce((u,f,r)=>{let c=t[r];if(c&&c.call){let a=c(o),s=a&&a.props&&a.props.className||/^go/.test(a)&&a;c=s?"."+s:a&&typeof a=="object"?a.props?"":S(a,""):a===!1?"":a}return u+f+(c??"")},"");function M(e){let t=this||{},o=e.call?e(t.p):e;return ce(o.unshift?o.raw?se(o,[].slice.call(arguments,1),t.p):o.reduce((u,f)=>Object.assign(u,f&&f.call?f(t.p):f),{}):o,re(t.target),t.g,t.o,t.k)}let fe=M.bind({g:1});M.bind({k:1});const de=b("<li class=empty>"),ue=b("<li class=leaf>"),ge=b("<li class=branch><div class=branch-label>"),me=b("<ul>");function he(e){return(()=>{const t=de();return p(t,()=>e.get.emptyLabel(e.prefix)),t})()}function $e(e){return(()=>{const t=ue();return p(t,()=>e.get.leafLabel(e.node,e.prefix)),t})()}function we(e){const t=()=>e.classNameExpanded||"expanded",o=()=>e.get.path(e.node,e.prefix),u=()=>e.get.childNodes(e.node);return(()=>{const f=ge(),r=f.firstChild;return r.$$click=c=>{console.log("branch-label clicked===>",c);let a=c.target;for(;a&&a.localName!="li";)a=a.parentNode;if(!a)throw{error:"li not found",event:c};if(a.classList.toggle(t()),e.onFolderSelected&&e.onFolderSelected(e.node,e.prefix),a.classList.contains("expanded")){const s=a.querySelector("i");s.className="far fa-folder-open"}else{const s=a.querySelector("i");s.className="far fa-folder"}a.classList.contains(t())&&e.load&&e.load(e.node,e.prefix,e.get)},p(r,()=>e.get.branchLabel(e.node,e.prefix)),p(f,()=>e.recurse({...e,data:u(),prefix:o()}),null),f})()}const pe=function e(t){return(()=>{const o=me();return p(o,E(J,{get each(){return F(()=>!!t.filter)()?t.data.filter(t.filter):t.data},get fallback(){return F(()=>!!t.component?.empty)()?t.component.empty(t):he(t)},children:(u,f)=>{const r=()=>({...t,node:u,nodeIdx:f,recurse:e});return E(z,{get when(){return t.get.isLeaf(u)},get fallback(){return F(()=>!!t.component?.branch)()?t.component.branch(r()):we(r())},get children(){return F(()=>!!t.component?.leaf)()?t.component.leaf(r()):$e(r())}})}})),K(()=>Q(o,(()=>"tree-view "+(t.prefix?"":"root ")+t.className)())),o})()},be=pe;q(["click"]);const ve=b("<span class=name>"),xe=b("<span class=link-target>"),ye=b('<i class="far fa-folder">'),_e=b('<span class=link-source><i class="far fa-file"></i> '),Le=b('<span class=file><i class="far fa-file"></i> '),ke=b("<button>"),Se=b('<div class="h-full ">');var O="",i="linux-find";O+=`
  .${i}.tree-view.root { margin-left: 1px; margin-right: 1px; }
  .${i}.tree-view.root { height: 100%; /* fit to container */; overflow: auto; /* scroll on demand */ }
  .${i}.tree-view { text-align: left; }
  .${i}.tree-view,
  .${i}.tree-view ul { list-style: none; padding: 0; }
  .${i}.tree-view li { white-space: pre; /* dont wrap on x overflow. TODO fix width on overflow */ }
  .${i}.tree-view li.branch > span { color: blue; font-family: monospace; }
  .${i}.tree-view li.branch > ul { display: none; /* default collapsed */ }
  .${i}.tree-view li.branch.expanded { outline: solid 1px grey; }
  .${i}.tree-view li.branch.expanded > ul { display: block; }
  .${i}.tree-view li.empty { font-style: italic; }
  .${i}.tree-view span.link-source { color: green; }
  .${i}.tree-view span.link-source,
  .${i}.tree-view div.branch-label,
  .${i}.tree-view span.file,
  .${i}.tree-view span.name,
  .${i}.tree-view span.prefix { font-family: monospace; cursor: pointer; }
  /* .${i}.tree-view span.prefix { opacity: 0.6; } */ /* this looks worse than expected */
`;var i="file-tree";O+=`
  .${i}.tree-view.root { margin-left: 1px; margin-right: 1px; }
  .${i}.tree-view.root { height: 100%; /* fit to container */; overflow: auto; /* scroll on demand */ }
  .${i}.tree-view { text-align: left; }
  .${i}.tree-view,
  .${i}.tree-view ul { width:100%;list-style: none; padding: 0; }
  .${i}.tree-view ul { padding-left: 0.5em; margin-left: 0.5em; border-left: solid 1px grey; }
  .${i}.tree-view li { white-space: pre; white-space: nowrap;/* dont wrap on x overflow. TODO fix width on overflow */ }
  .${i}.tree-view li.branch > span { color: blue; font-family: monospace; }
  .${i}.tree-view li.branch > ul { display: none; /* default collapsed */ }
  .${i}.tree-view li.branch.expanded {  }
  .${i}.tree-view li.branch.expanded > ul { display: block; }
  .${i}.tree-view li.empty { font-style: italic; }
  .${i}.tree-view span.link-source { color: green; }
  .${i}.tree-view span.link-source,
  .${i}.tree-view div.branch-label,
  .${i}.tree-view span.file,
  .${i}.tree-view span.name { font-family: monospace; cursor: pointer; }
  .${i}.tree-view span.name:bexfore {    content: "\\f07b";    font-family: "Font Awesome 5 Free"; padding-right: 5px; }
`;fe(O);function Ee(e){const[t,o]=U({fileList:[],fileSelected:""}),[u,f]=D({}),[r,c]=D({}),[a]=X(le);async function s(){ne({rootDirectory:".",excludeFilter:".*"},m=>{c(m),x()},m=>{toast(m)})}async function h(){o("fileList",[]),await s()}Y(async()=>{await s()}),ee(async()=>{console.log("createEffect..."),a()&&await s(),a()||o("fileList",[])});const g="/";function v(l,m){if(l.length>1&&l.endsWith("/")&&(l=l.substring(0,l.length-1)),l.startsWith("/")||(l="/"+l),l=="/")return m;let y=l.split("/");y.shift();for(const w of m)if(w.n===y[0])return y.length===1?typeof w.c<"u"?w.c:[]:v(y.slice(1).join("/"),w.c);return[]}async function x(l=null,m="",y=null){const w=l&&y?y.path(l,m):g,L=["fileList"],N=3;let n=t.fileList;if(w.split("/").filter(Boolean).forEach((k,G)=>{const T=n.findIndex(([Fe,H,Z,Ne])=>H=="d"&&Z==k);L.push(T),n=n[T],L.push(N),n=n[N]}),n.length>0)return;const $=w.split("/").filter(Boolean).length;console.log(`loadFiles path = "${w}" + depth "${$}" + prefix "${m}"`);var d=r();if(typeof d.files>"u")return;var C=v(w,d.files.c);w=="/"&&(C=d.files.c);const j={files:C.map((k,G)=>{if(k.d)return[$,"d",k.n,[]];if(!k.d)return[$,"f",k.n,k.s]})};console.log(j),!t.fileList||t.fileList.length==0?o("fileList",j.files):o(...L,j.files)}function V(l){e.onSelected&&e.onSelected(l)}function I(l,m){typeof m>"u"&&(m=""),e.onFolderSelected&&e.onFolderSelected(l[2],m)}function R(){const l={};l.isLeaf=n=>n[1]!="d",l.name=n=>n[2]+(n[1]=="d"?"/":""),l.path=(n,$)=>($||g)+l.name(n),l.childNodes=n=>n[3],l.emptyLabel=n=>" - - -";const m=n=>n[1]=="l",y=n=>n[1]=="f",w=n=>n[3],L=(n,$)=>(()=>{const d=ve();return p(d,()=>l.name(n)),d})(),N=(n,$)=>()=>{o("fileSelected",l.path(n,$)),V(l.path(n,$))};return l.branchLabel=(n,$)=>[ye()," ",F(()=>L(n))],l.leafLabel=(n,$)=>{if(m(n))return[(()=>{const d=_e();return d.firstChild.nextSibling,B(d,"click",N(n,$),!0),p(d,()=>L(n),null),d})()," -> ",(()=>{const d=xe();return p(d,()=>w(n)),d})()];if(y(n))return(()=>{const d=Le();return d.firstChild.nextSibling,B(d,"click",N(n,$),!0),p(d,()=>L(n),null),d})()},l}function W(){return l=>l[2][0]!="."}return[(()=>{const l=ke();return l.$$click=h,p(l,E(te,{})),l})()," ",F(()=>t.fileSelected),(()=>{const l=Se();return p(l,E(be,{selectnode:u,get data(){return t.fileList},get get(){return R()},get filter(){return W()},onFolderSelected:I,load:x,className:"file-tree"})),l})()]}q(["click"]);export{Ee as default};
