import{i as p,e as C,b as F,S as Q,F as U,f as M,g as P,n as A,t as b,a as j,o as R,h as X,d as Y,w as ee,u as te,k as ne,a2 as le,B,aq as ie,av as re}from"./index.9f7275fd.js";let ae={data:""},oe=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||ae,ce=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,se=/\/\*[^]*?\*\/|  +/g,I=/\n+/g,S=(e,t)=>{let a="",f="",s="";for(let r in e){let o=e[r];r[0]=="@"?r[1]=="i"?a=r+" "+o+";":f+=r[1]=="f"?S(o,r):r+"{"+S(o,r[1]=="k"?"":t)+"}":typeof o=="object"?f+=S(o,t?t.replace(/([^,])+/g,c=>r.replace(/(^:.*)|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,c):c?c+" "+d:d)):r):o!=null&&(r=/^--/.test(r)?r:r.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=S.p?S.p(r,o):r+":"+o+";")}return a+(t&&s?t+"{"+s+"}":s)+f},_={},V=e=>{if(typeof e=="object"){let t="";for(let a in e)t+=a+V(e[a]);return t}return e},fe=(e,t,a,f,s)=>{let r=V(e),o=_[r]||(_[r]=(d=>{let m=0,g=11;for(;m<d.length;)g=101*g+d.charCodeAt(m++)>>>0;return"go"+g})(r));if(!_[o]){let d=r!==e?e:(m=>{let g,v,x=[{}];for(;g=ce.exec(m.replace(se,""));)g[4]?x.shift():g[3]?(v=g[3].replace(I," ").trim(),x.unshift(x[0][v]=x[0][v]||{})):x[0][g[1]]=g[2].replace(I," ").trim();return x[0]})(e);_[o]=S(s?{["@keyframes "+o]:d}:d,a?"":"."+o)}let c=a&&_.g?_.g:null;return a&&(_.g=_[o]),((d,m,g,v)=>{v?m.data=m.data.replace(v,d):m.data.indexOf(d)===-1&&(m.data=g?d+m.data:m.data+d)})(_[o],t,f,c),o},de=(e,t,a)=>e.reduce((f,s,r)=>{let o=t[r];if(o&&o.call){let c=o(a),d=c&&c.props&&c.props.className||/^go/.test(c)&&c;o=d?"."+d:c&&typeof c=="object"?c.props?"":S(c,""):c===!1?"":c}return f+s+(o??"")},"");function q(e){let t=this||{},a=e.call?e(t.p):e;return fe(a.unshift?a.raw?de(a,[].slice.call(arguments,1),t.p):a.reduce((f,s)=>Object.assign(f,s&&s.call?s(t.p):s),{}):a,oe(t.target),t.g,t.o,t.k)}let ue=q.bind({g:1});q.bind({k:1});const ge=b("<li class=empty>"),he=b("<li class=leaf>"),me=b("<li class=branch><div class=branch-label>"),$e=b("<ul>");function we(e){return(()=>{const t=ge();return p(t,()=>e.get.emptyLabel(e.prefix)),t})()}function pe(e){return(()=>{const t=he();return p(t,()=>e.get.leafLabel(e.node,e.prefix)),t})()}function be(e){const t=()=>e.classNameExpanded||"expanded",a=()=>e.get.path(e.node,e.prefix),f=()=>e.get.childNodes(e.node);return(()=>{const s=me(),r=s.firstChild;return r.$$click=o=>{console.log("branch-label clicked===>",o);let c=o.target;for(;c&&c.localName!="li";)c=c.parentNode;if(!c)throw{error:"li not found",event:o};c.classList.toggle(t()),e.onFolderSelected&&e.onFolderSelected(e.node,e.prefix),c.classList.contains(t())&&e.load&&e.load(e.node,e.prefix,e.get)},p(r,()=>e.get.branchLabel(e.node,e.prefix)),p(s,()=>e.recurse({...e,data:f(),prefix:a()}),null),s})()}const ve=function e(t){return(()=>{const a=$e();return p(a,C(U,{get each(){return F(()=>!!t.filter)()?t.data.filter(t.filter):t.data},get fallback(){return F(()=>!!t.component?.empty)()?t.component.empty(t):we(t)},children:(f,s)=>{const r=()=>({...t,node:f,nodeIdx:s,recurse:e});return C(Q,{get when(){return t.get.isLeaf(f)},get fallback(){return F(()=>!!t.component?.branch)()?t.component.branch(r()):be(r())},get children(){return F(()=>!!t.component?.leaf)()?t.component.leaf(r()):pe(r())}})}})),M(()=>P(a,(()=>"tree-view "+(t.prefix?"":"root ")+t.className)())),a})()},xe=ve;A(["click"]);const ye=b("<i>");function _e(){let e;const[t,a]=j("fa-solid  fa-folder");return R(()=>{const f=new MutationObserver(s=>{for(let r of s)if(r.type==="attributes"){const o=e.parentNode.parentNode;a(o.classList.contains("expanded")?"far fa-folder-open":"fa-solid fa-folder")}});f.observe(e.parentNode.parentNode,{attributes:!0}),X(()=>{f.disconnect()})}),(()=>{const f=ye(),s=e;return typeof s=="function"?Y(s,f):e=f,M(()=>P(f,t())),f})()}const Le=b("<span class=name>"),ke=b("<span class=link-target>"),Se=b('<span class=link-source><i class="far fa-file"></i> '),Fe=b('<span class=file><i class="far fa-file"></i> '),Ne=b("<button>"),Ce=b('<div class="h-full ">');var T="",i="linux-find";T+=`
  .${i}.tree-view.root { margin-left: 1px; margin-right: 1px; }
  .${i}.tree-view.root { height: 100%; /* fit to container */; overflow: auto; /* scroll on demand */ }
  .${i}.tree-view { text-align: left; }
  .${i}.tree-view,
  .${i}.tree-view ul { list-style: none; padding: 0; }
  .${i}.tree-view li { white-space: pre; /* dont wrap on x overflow. TODO fix width on overflow */ }
  .${i}.tree-view li.branch > span { color: blue; font-family: monospace; }
  .${i}.tree-view li.branch > ul { display: none; /* default collapsed */ }
  .${i}.tree-view li.branch.expanded { outline: solid 1px grey; }
  .${i}.tree-view li.branch.expanded > ul { display: block; }
  .${i}.tree-view li.empty { font-style: italic; }
  .${i}.tree-view span.link-source { color: green; }
  .${i}.tree-view span.link-source,
  .${i}.tree-view div.branch-label,
  .${i}.tree-view span.file,
  .${i}.tree-view span.name,
  .${i}.tree-view span.prefix { font-family: monospace; cursor: pointer; }
  /* .${i}.tree-view span.prefix { opacity: 0.6; } */ /* this looks worse than expected */
`;var i="file-tree";T+=`
  .${i}.tree-view.root { margin-left: 1px; margin-right: 1px; }
  .${i}.tree-view.root { height: 100%; /* fit to container */; overflow: auto; /* scroll on demand */ }
  .${i}.tree-view { text-align: left; }
  .${i}.tree-view,
  .${i}.tree-view ul { width:100%;list-style: none; padding: 0; }
  .${i}.tree-view ul { padding-left: 0.5em; margin-left: 0.5em; border-left: solid 1px grey; }
  .${i}.tree-view li { white-space: pre; white-space: nowrap;/* dont wrap on x overflow. TODO fix width on overflow */ }
  .${i}.tree-view li.branch > span { color: blue; font-family: monospace; }
  .${i}.tree-view li.branch > ul { display: none; /* default collapsed */ }
  .${i}.tree-view li.branch.expanded {  }
  .${i}.tree-view li.branch.expanded > ul { display: block; }
  .${i}.tree-view li.empty { font-style: italic; }
  .${i}.tree-view span.link-source { color: green; }
  .${i}.tree-view span.link-source,
  .${i}.tree-view div.branch-label,
  .${i}.tree-view span.file,
  .${i}.tree-view span.name { font-family: monospace; cursor: pointer; }
  .${i}.tree-view span.name:bexfore {    content: "\\f07b";    font-family: "Font Awesome 5 Free"; padding-right: 5px; }
`;ue(T);function Te(e){const[t,a]=ee({fileList:[],fileSelected:""}),[f,s]=j({}),[r,o]=j({}),[c]=te(ie);async function d(){re({rootDirectory:".",excludeFilter:".*"},h=>{o(h),x()},h=>{toast(h)})}async function m(){a("fileList",[]),await d()}R(async()=>{await d()}),ne(async()=>{console.log("createEffect..."),c()&&await d(),c()||a("fileList",[])});const g="/";function v(n,h){if(n.length>1&&n.endsWith("/")&&(n=n.substring(0,n.length-1)),n.startsWith("/")||(n="/"+n),n=="/")return h;let y=n.split("/");y.shift();for(const w of h)if(w.n===y[0])return y.length===1?typeof w.c<"u"?w.c:[]:v(y.slice(1).join("/"),w.c);return[]}async function x(n=null,h="",y=null){const w=n&&y?y.path(n,h):g,L=["fileList"],N=3;let l=t.fileList;if(w.split("/").filter(Boolean).forEach((k,z)=>{const D=l.findIndex(([Oe,J,K,Ee])=>J=="d"&&K==k);L.push(D),l=l[D],L.push(N),l=l[N]}),l.length>0)return;const $=w.split("/").filter(Boolean).length;console.log(`loadFiles path = "${w}" + depth "${$}" + prefix "${h}"`);var u=r();if(typeof u.files>"u")return;var O=v(w,u.files.c);w=="/"&&(O=u.files.c);const E={files:O.map((k,z)=>{if(k.d)return[$,"d",k.n,[]];if(!k.d)return[$,"f",k.n,k.s]})};console.log(E),!t.fileList||t.fileList.length==0?a("fileList",E.files):a(...L,E.files)}function W(n){e.onSelected&&e.onSelected(n)}function G(n,h){typeof h>"u"&&(h=""),e.onFolderSelected&&e.onFolderSelected(n[2],h)}function H(){const n={};n.isLeaf=l=>l[1]!="d",n.name=l=>l[2]+(l[1]=="d"?"/":""),n.path=(l,$)=>($||g)+n.name(l),n.childNodes=l=>l[3],n.emptyLabel=l=>" - - -";const h=l=>l[1]=="l",y=l=>l[1]=="f",w=l=>l[3],L=(l,$)=>(()=>{const u=Le();return p(u,()=>n.name(l)),u})(),N=(l,$)=>()=>{a("fileSelected",n.path(l,$)),W(n.path(l,$))};return n.branchLabel=(l,$)=>[C(_e,{})," ",F(()=>L(l))],n.leafLabel=(l,$)=>{if(h(l))return[(()=>{const u=Se();return u.firstChild.nextSibling,B(u,"click",N(l,$),!0),p(u,()=>L(l),null),u})()," -> ",(()=>{const u=ke();return p(u,()=>w(l)),u})()];if(y(l))return(()=>{const u=Fe();return u.firstChild.nextSibling,B(u,"click",N(l,$),!0),p(u,()=>L(l),null),u})()},n}function Z(){return n=>n[2][0]!="."}return[(()=>{const n=Ne();return n.$$click=m,p(n,C(le,{})),n})()," ",F(()=>t.fileSelected),(()=>{const n=Ce();return p(n,C(xe,{selectnode:f,get data(){return t.fileList},get get(){return H()},get filter(){return Z()},onFolderSelected:G,load:x,className:"file-tree"})),n})()]}A(["click"]);export{Te as default};
